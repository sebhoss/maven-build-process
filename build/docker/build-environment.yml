#
# This file is part of maven-build-process. It is subject to the license terms in the LICENSE file found in the top-level
# directory of this distribution and at http://creativecommons.org/publicdomain/zero/1.0/. No part of maven-build-process,
# including this file, may be copied, modified, propagated, or distributed except according to the terms contained
# in the LICENSE file.
#

version: '2'

services:
  # see https://hub.docker.com/r/sebhoss/maven-build-environment/
  maven-build-environment:
    build:
      context: "../../"
      dockerfile: build/docker/Dockerfile
      args:
        NEXUS_HOST: "${NEXUS_HOST}"
    image: sebhoss/maven-build-environment
  verify-project:
    image: sebhoss/maven-build-environment:latest
    container_name: maven-build-process-verifier
    depends_on:
      - maven-build-environment
    volumes:
      - "../../:/project"
    working_dir: /project
    external_links:
      - local-nexus:nexus
    command: mvn clean verify -s /config/settings.xml -Dmaven.repo.local=/repository
    network_mode: bridge
